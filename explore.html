<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore Music Stories - Musicstory</title>
    <link rel="stylesheet" href="explore.css">
</head>
<body>
    <!-- Header/Navigation -->
    <header class="header">
        <div class="nav-container">
            <div class="logo">
                <h1>Musicstory</h1>
            </div>
            <nav class="navigation">
                <a href="index.html" class="nav-link">Home</a>
                <a href="explore.html" class="nav-link active">Explore</a>
                <a href="hits.html" class="nav-link">Top hits</a>
            </nav>
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search songs...">
                <button class="search-button">Search</button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <h1 class="hero-title">Explore Music Stories</h1>
            <p class="hero-description">
                Dive deep into the fascinating world of music and discover the stories behind your favorite songs
            </p>
        </div>
    </section>

    <!-- Featured Song Section -->
    <section class="featured-section">
        <div class="container">
            <h2 class="section-title">Featured Song</h2>
            
            <div class="featured-song">
                <div class="song-image">
                    <img src="./pics/gloc.jpg" alt="Love Story by Gloc 9" onerror="this.src='https://via.placeholder.com/200x200?text=Love+Story'" />
                </div>
                
                <div class="song-info">
                    <h3 class="song-title">Love Story</h3>
                    <p class="artist-name">By Gloc 9</p>
                    
                    <div class="song-description">
                        <p>"Love Story" by Gloc 9 is a powerful Filipino hip-hop track that tells a compelling narrative about love in the face of social and economic challenges. Known for his socially conscious lyrics, Gloc 9 weaves a story that resonates with many Filipinos, touching on themes of perseverance, hope, and the struggles of everyday life while maintaining love and relationships.</p>
                    </div>
                    
                    <div class="action-buttons">
                        <a href="https://open.spotify.com/search/Love%20Story%20Gloc%209" target="_blank" class="btn btn-spotify">Listen on Spotify</a>
                        <a href="#lovestory-modal" class="btn btn-secondary">See more information</a>
                        <button class="btn btn-like" id="like-lovestory" onclick="toggleSongLike('lovestory')">
                            <span class="heart-icon">ü§ç</span> <span class="like-count">0</span>
                        </button>
                        <button class="btn btn-comment" onclick="toggleComments('lovestory')">Comments</button>
                    </div>
                    
                    <!-- Comment Section for Love Story -->
                    <div id="lovestory-comments" class="comment-section" style="display: none;">
                        <h4>Share Your Understanding</h4>
                        <p class="comment-subtitle">Express what this song means to you</p>
                        
                        <div class="comment-form">
                            <input type="text" class="comment-name" placeholder="Your name" />
                            <textarea class="comment-text" placeholder="Share your thoughts about the story behind this music..." rows="4"></textarea>
                            <button class="btn-submit-comment" onclick="submitComment('lovestory')">Post Comment</button>
                        </div>
                        
                        <div class="comments-list" id="lovestory-comments-list">
                            <!-- Comments will appear here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pahina by Cup of Joe -->
            <div class="featured-song">
                <div class="song-image">
                    <img src="./pics/OIP.jpeg" alt="Pahina by Cup of Joe" onerror="this.src='https://via.placeholder.com/200x200?text=Pahina'" />
                </div>
                
                <div class="song-info">
                    <h3 class="song-title">Pahina</h3>
                    <p class="artist-name">By Cup of Joe</p>
                    
                    <div class="song-description">
                        <p>The song "Pahina" by Cup of Joe, released on January 17, 2025, as part of their album "Silakbo," delves into the intricate themes of love, longing, and the bittersweet nature of relationships. This poignant track captures the essence of nostalgia, reflecting on cherished moments shared with a loved one while also acknowledging the emotional complexities that accompany such connections. The title "Pahina," which translates to "page" in English, symbolizes the turning of pages in a book, representing the various chapters of life and love that shape our experiences.</p>
                    </div>
                    
                    <div class="action-buttons">
                        <a href="https://open.spotify.com/search/Pahina%20Cup%20of%20Joe" target="_blank" class="btn btn-spotify">Listen on Spotify</a>
                        <a href="#pahina-modal" class="btn btn-secondary">See more information</a>
                        <button class="btn btn-like" id="like-pahina" onclick="toggleSongLike('pahina')">
                            <span class="heart-icon">ü§ç</span> <span class="like-count">0</span>
                        </button>
                        <button class="btn btn-comment" onclick="toggleComments('pahina')">Comments</button>
                    </div>
                    
                    <!-- Comment Section for Pahina -->
                    <div id="pahina-comments" class="comment-section" style="display: none;">
                        <h4>Share Your Understanding</h4>
                        <p class="comment-subtitle">Express what this song means to you</p>
                        
                        <div class="comment-form">
                            <input type="text" class="comment-name" placeholder="Your name" />
                            <textarea class="comment-text" placeholder="Share your thoughts about the story behind this music..." rows="4"></textarea>
                            <button class="btn-submit-comment" onclick="submitComment('pahina')">Post Comment</button>
                        </div>
                        
                        <div class="comments-list" id="pahina-comments-list">
                            <!-- Comments will appear here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modals -->
    <!-- Love Story Modal -->
    <div id="lovestory-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Love Story - Gloc 9</h2>
                <a href="#" class="close">&times;</a>
            </div>
            <div class="modal-body">
                <div class="modal-song-info">
                    <img src="./pics/gloc.jpg" alt="Love Story by Gloc 9" class="modal-image" onerror="this.src='https://via.placeholder.com/150x150?text=Love+Story'" />
                    <div class="modal-details">
                        <h3>Artist: Gloc 9</h3>
                        <p><strong>Genre:</strong> Filipino Hip-Hop, OPM Rap</p>
                        <p><strong>Language:</strong> Filipino/Tagalog</p>
                        <p><strong>Artist:</strong> Gloc 9 (Aristotle Pollisco)</p>
                        <p><strong>Style:</strong> Socially Conscious Rap</p>
                    </div>
                </div>
                <div class="modal-description">
                    <h4>About the Song</h4>
                    <p>"Love Story" by Gloc 9 is a powerful Filipino hip-hop track that tells a compelling narrative about love in the face of social and economic challenges. Known for his socially conscious lyrics, Gloc 9 weaves a story that resonates with many Filipinos, touching on themes of perseverance, hope, and the struggles of everyday life while maintaining love and relationships.</p>
                    
                    <p>Gloc 9, one of the most respected rappers in the Philippines, is known for his ability to blend storytelling with social commentary. His songs often highlight the realities faced by ordinary Filipinos, making his music both relatable and thought-provoking.</p>
                    
                    <p>"Love Story" showcases Gloc 9's signature style of rapid-fire delivery combined with meaningful lyrics. The track demonstrates his mastery of wordplay and his commitment to creating music that speaks to the Filipino experience, making it a standout piece in OPM hip-hop.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Pahina Modal -->
    <div id="pahina-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Pahina - Cup of Joe</h2>
                <a href="#" class="close">&times;</a>
            </div>
            <div class="modal-body">
                <div class="modal-song-info">
                    <img src="./pics/OIP.jpeg" alt="Pahina by Cup of Joe" class="modal-image" onerror="this.src='https://via.placeholder.com/150x150?text=Pahina'" />
                    <div class="modal-details">
                        <h3>Album: Silakbo</h3>
                        <p><strong>Release Date:</strong> January 17, 2025</p>
                        <p><strong>Genre:</strong> OPM, Indie Pop</p>
                        <p><strong>Artist:</strong> Cup of Joe</p>
                        <p><strong>Language:</strong> Filipino</p>
                    </div>
                </div>
                <div class="modal-description">
                    <h4>About the Song</h4>
                    <p>The song "Pahina" by Cup of Joe, released on January 17, 2025, as part of their album "Silakbo," delves into the intricate themes of love, longing, and the bittersweet nature of relationships. This poignant track captures the essence of nostalgia, reflecting on cherished moments shared with a loved one while also acknowledging the emotional complexities that accompany such connections.</p>
                    
                    <p>The title "Pahina," which translates to "page" in English, symbolizes the turning of pages in a book, representing the various chapters of life and love that shape our experiences. The song's lyrics explore how relationships evolve over time, with each moment becoming a page in the story of two people's lives.</p>
                    
                    <p>Musically, "Pahina" showcases Cup of Joe's signature sound, blending contemporary OPM with indie pop sensibilities. The song's gentle melody and heartfelt delivery make it a standout track that resonates with listeners who have experienced the complexities of love and relationships.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 Musicstory. Celebrating Filipino Music.</p>
    </footer>

    <script>
        // Search functionality
        const searchInput = document.querySelector('.search-input');
        const searchButton = document.querySelector('.search-button');
        const featuredSongs = document.querySelectorAll('.featured-song');

        // Function to perform search
        function performSearch() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            featuredSongs.forEach(song => {
                const title = song.querySelector('.song-title').textContent.toLowerCase();
                const artist = song.querySelector('.artist-name').textContent.toLowerCase();
                const description = song.querySelector('.song-description').textContent.toLowerCase();
                
                // Check if search term matches title, artist, or description
                if (title.includes(searchTerm) || artist.includes(searchTerm) || description.includes(searchTerm)) {
                    song.style.display = 'flex';
                    song.style.animation = 'fadeIn 0.5s ease';
                } else {
                    song.style.display = 'none';
                }
            });

            // If search is empty, show all songs
            if (searchTerm === '') {
                featuredSongs.forEach(song => {
                    song.style.display = 'flex';
                });
            }
        }

        // Search on button click
        searchButton.addEventListener('click', performSearch);

        // Search on Enter key press
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                performSearch();
            }
        });

        // Real-time search as user types
        searchInput.addEventListener('input', performSearch);

        // Add fade-in animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        `;
        document.head.appendChild(style);

        // Song Like functionality
        function getSongLikes(songId) {
            const likes = localStorage.getItem(`song_likes_${songId}`);
            return likes ? JSON.parse(likes) : { count: 0, liked: false };
        }

        function saveSongLikes(songId, likesData) {
            localStorage.setItem(`song_likes_${songId}`, JSON.stringify(likesData));
        }

        function toggleSongLike(songId) {
            const likesData = getSongLikes(songId);
            const button = document.getElementById(`like-${songId}`);
            const heartIcon = button.querySelector('.heart-icon');
            const likeCount = button.querySelector('.like-count');
            
            if (likesData.liked) {
                // Unlike
                likesData.count = Math.max(0, likesData.count - 1);
                likesData.liked = false;
                button.classList.remove('liked');
                heartIcon.textContent = 'ü§ç';
            } else {
                // Like
                likesData.count++;
                likesData.liked = true;
                button.classList.add('liked');
                heartIcon.textContent = '‚ù§Ô∏è';
            }
            
            likeCount.textContent = likesData.count;
            saveSongLikes(songId, likesData);
        }

        // Load like counts on page load
        function loadSongLikes() {
            const songs = ['lovestory', 'pahina'];
            songs.forEach(songId => {
                const likesData = getSongLikes(songId);
                const button = document.getElementById(`like-${songId}`);
                if (button) {
                    const heartIcon = button.querySelector('.heart-icon');
                    const likeCount = button.querySelector('.like-count');
                    
                    likeCount.textContent = likesData.count;
                    if (likesData.liked) {
                        button.classList.add('liked');
                        heartIcon.textContent = '‚ù§Ô∏è';
                    } else {
                        heartIcon.textContent = 'ü§ç';
                    }
                }
            });
        }

        // Load likes when page loads
        window.addEventListener('DOMContentLoaded', loadSongLikes);

        // Comment functionality
        // Store comments in localStorage
        function getComments(songId) {
            const comments = localStorage.getItem(`comments_${songId}`);
            return comments ? JSON.parse(comments) : [];
        }

        function saveComments(songId, comments) {
            localStorage.setItem(`comments_${songId}`, JSON.stringify(comments));
        }

        function toggleComments(songId) {
            console.log('toggleComments called with:', songId);
            const commentSection = document.getElementById(`${songId}-comments`);
            console.log('commentSection found:', commentSection);
            if (commentSection.style.display === 'none' || commentSection.style.display === '') {
                commentSection.style.display = 'block';
                commentSection.style.animation = 'fadeIn 0.5s ease';
                loadComments(songId);
            } else {
                commentSection.style.display = 'none';
            }
        }

        function submitComment(songId) {
            const nameInput = document.querySelector(`#${songId}-comments .comment-name`);
            const textInput = document.querySelector(`#${songId}-comments .comment-text`);
            
            const name = nameInput.value.trim();
            const text = textInput.value.trim();
            
            if (!name || !text) {
                alert('Please enter your name and comment!');
                return;
            }
            
            const comments = getComments(songId);
            const newComment = {
                name: name,
                text: text,
                date: new Date().toLocaleDateString(),
                time: new Date().toLocaleTimeString(),
                hearts: 0,
                replies: []
            };
            
            comments.unshift(newComment);
            saveComments(songId, comments);
            
            nameInput.value = '';
            textInput.value = '';
            
            loadComments(songId);
        }

        function loadComments(songId) {
            const comments = getComments(songId);
            const commentsList = document.getElementById(`${songId}-comments-list`);
            
            if (comments.length === 0) {
                commentsList.innerHTML = '<p class="no-comments">No comments yet. Be the first to share your thoughts!</p>';
                return;
            }
            
            commentsList.innerHTML = comments.map((comment, index) => {
                const replyCount = comment.replies ? comment.replies.length : 0;
                const showRepliesButton = replyCount > 0 
                    ? `<button class="btn-view-replies" onclick="toggleReplies('${songId}', ${index})">
                         View ${replyCount} ${replyCount === 1 ? 'reply' : 'replies'}
                       </button>`
                    : '';
                
                const repliesHtml = comment.replies && comment.replies.length > 0 
                    ? comment.replies.map((reply, replyIndex) => {
                        const escapedName = reply.name.replace(/'/g, "\\'");
                        return `
                        <div class="tiktok-reply-item">
                            <div class="reply-main">
                                <span class="reply-author">${reply.name}</span>
                                ${reply.replyingTo ? `<span class="replying-to">@${reply.replyingTo}</span>` : ''}
                            </div>
                            <div class="reply-body">${reply.text}</div>
                            <div class="reply-meta">
                                <span class="reply-date">${reply.date}</span>
                                <button class="btn-tiktok-heart ${reply.hearted ? 'hearted' : ''}" onclick="toggleReplyHeart('${songId}', ${index}, ${replyIndex})">
                                    ${reply.hearts || 0}
                                </button>
                                <button class="btn-tiktok-reply" onclick="showTikTokReplyBox('${songId}', ${index}, ${replyIndex}, '${escapedName}')">Reply</button>
                            </div>
                        </div>
                    `;
                    }).join('')
                    : '';
                
                return `
                <div class="comment-item" id="${songId}-comment-${index}">
                    <div class="comment-header">
                        <span class="comment-author">üë§ ${comment.name}</span>
                        <span class="comment-date">${comment.date} at ${comment.time}</span>
                    </div>
                    <p class="comment-content">${comment.text}</p>
                    <div class="comment-actions">
                        <button class="btn-heart-comment ${comment.hearted ? 'hearted' : ''}" onclick="toggleHeart('${songId}', ${index})">
                            ‚ù§Ô∏è ${comment.hearts || 0}
                        </button>
                        <button class="btn-reply-comment" onclick="showReplyBox('${songId}', ${index})">Reply</button>
                        <button class="btn-delete-comment" onclick="deleteComment('${songId}', ${index})">Delete</button>
                    </div>
                    ${showRepliesButton}
                    <div class="reply-box" id="${songId}-reply-${index}" style="display: none;">
                        <input type="text" class="reply-name" placeholder="Your name" />
                        <textarea class="reply-text" placeholder="Write your reply..." rows="2"></textarea>
                        <input type="hidden" class="replying-to-name" value="" />
                        <div class="reply-buttons">
                            <button class="btn-submit-reply" onclick="submitReply('${songId}', ${index})">Post Reply</button>
                            <button class="btn-cancel-reply" onclick="hideReplyBox('${songId}', ${index})">Cancel</button>
                        </div>
                    </div>
                    <div class="tiktok-replies-container" id="${songId}-replies-${index}" style="display: none;">
                        ${repliesHtml}
                    </div>
                </div>
            `;
            }).join('');

        }


        function toggleHeart(songId, index) {
            const comments = getComments(songId);
            if (!comments[index].hearts) {
                comments[index].hearts = 0;
            }
            
            if (comments[index].hearted) {
                comments[index].hearts--;
                comments[index].hearted = false;
            } else {
                comments[index].hearts++;
                comments[index].hearted = true;
            }
            
            saveComments(songId, comments);
            loadComments(songId);
        }

        function showReplyBox(songId, index) {
            const replyBox = document.getElementById(`${songId}-reply-${index}`);
            replyBox.style.display = 'block';
            replyBox.style.animation = 'fadeIn 0.3s ease';
        }

        function hideReplyBox(songId, index) {
            const replyBox = document.getElementById(`${songId}-reply-${index}`);
            replyBox.style.display = 'none';
        }

        function submitReply(songId, commentIndex) {
            const replyBox = document.getElementById(`${songId}-reply-${commentIndex}`);
            const nameInput = replyBox.querySelector('.reply-name');
            const textInput = replyBox.querySelector('.reply-text');
            const replyingToInput = replyBox.querySelector('.replying-to-name');
            
            const name = nameInput.value.trim();
            const text = textInput.value.trim();
            const replyingTo = replyingToInput.value;
            
            if (!name || !text) {
                alert('Please enter your name and reply!');
                return;
            }
            
            const comments = getComments(songId);
            if (!comments[commentIndex].replies) {
                comments[commentIndex].replies = [];
            }
            
            const newReply = {
                name: name,
                text: text,
                replyingTo: replyingTo || '',
                date: new Date().toLocaleDateString(),
                time: new Date().toLocaleTimeString(),
                hearts: 0,
                hearted: false
            };
            
            comments[commentIndex].replies.push(newReply);
            saveComments(songId, comments);
            
            nameInput.value = '';
            textInput.value = '';
            hideReplyBox(songId, commentIndex);
            
            loadComments(songId);
            
            // Automatically show replies after posting
            setTimeout(() => {
                const repliesContainer = document.getElementById(`${songId}-replies-${commentIndex}`);
                if (repliesContainer) {
                    repliesContainer.style.display = 'block';
                }
            }, 100);
        }

        function toggleReplies(songId, index) {
            const repliesContainer = document.getElementById(`${songId}-replies-${index}`);
            const button = event.target;
            
            if (repliesContainer.style.display === 'none') {
                repliesContainer.style.display = 'block';
                repliesContainer.style.animation = 'fadeIn 0.3s ease';
                button.textContent = 'Hide replies';
            } else {
                repliesContainer.style.display = 'none';
                const comments = getComments(songId);
                const replyCount = comments[index].replies ? comments[index].replies.length : 0;
                button.textContent = `View ${replyCount} ${replyCount === 1 ? 'reply' : 'replies'}`;
            }
        }

        function showTikTokReplyBox(songId, commentIndex, replyIndex, replyToName) {
            const replyBox = document.getElementById(`${songId}-reply-${commentIndex}`);
            const replyingToInput = replyBox.querySelector('.replying-to-name');
            const textInput = replyBox.querySelector('.reply-text');
            
            replyingToInput.value = replyToName;
            textInput.placeholder = `Replying to @${replyToName}...`;
            textInput.focus();
            
            replyBox.style.display = 'block';
            replyBox.style.animation = 'fadeIn 0.3s ease';
            
            // Scroll to reply box
            replyBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function toggleReplyHeart(songId, commentIndex, replyIndex) {
            const comments = getComments(songId);
            const reply = comments[commentIndex].replies[replyIndex];
            
            if (!reply.hearts) {
                reply.hearts = 0;
            }
            
            if (reply.hearted) {
                reply.hearts--;
                reply.hearted = false;
            } else {
                reply.hearts++;
                reply.hearted = true;
            }
            
            saveComments(songId, comments);
            loadComments(songId);
            
            // Keep replies visible after hearting
            setTimeout(() => {
                const repliesContainer = document.getElementById(`${songId}-replies-${commentIndex}`);
                if (repliesContainer) {
                    repliesContainer.style.display = 'block';
                }
            }, 100);
        }

        function deleteComment(songId, index) {
            if (confirm('Are you sure you want to delete this comment?')) {
                const comments = getComments(songId);
                comments.splice(index, 1);
                saveComments(songId, comments);
                loadComments(songId);
            }
        }
    </script>
</body>
</html>